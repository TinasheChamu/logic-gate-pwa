<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Digital Electronics FPGA Lab</title>

<style>
body {
    font-family: Arial, sans-serif;
    text-align: center;
    background: #111;
    color: white;
}

/* LED ARRAY */
.led-container {
    display: flex;
    justify-content: center;
    gap: 10px;
    margin: 20px 0;
}

.led {
    width: 35px;
    height: 35px;
    border-radius: 50%;
    background-color: #222;
}

.led.on {
    background-color: lime;
    box-shadow: 0 0 15px lime;
}

/* 7 Segment */
.seven-segment {
    position: relative;
    width: 120px;
    height: 200px;
    margin: 20px auto;
}

.segment {
    position: absolute;
    background: #222;
}

.segment.on {
    background: red;
    box-shadow: 0 0 10px red;
}

.a { top: 0; left: 30px; width: 60px; height: 15px; }
.b { top: 20px; right: 0; width: 15px; height: 60px; }
.c { bottom: 20px; right: 0; width: 15px; height: 60px; }
.d { bottom: 0; left: 30px; width: 60px; height: 15px; }
.e { bottom: 20px; left: 0; width: 15px; height: 60px; }
.f { top: 20px; left: 0; width: 15px; height: 60px; }
.g { top: 90px; left: 30px; width: 60px; height: 15px; }

textarea {
    width: 90%;
    max-width: 500px;
}

button {
    padding: 10px;
    margin-top: 10px;
}
</style>
</head>

<body>

<h1>FPGA Virtual Digital Lab</h1>

<h2>Simple HDL Editor</h2>

<textarea id="hdlCode" rows="6">
OUT = A AND B;
</textarea><br>

<div>
A <input type="checkbox" id="inputA">
B <input type="checkbox" id="inputB">
C <input type="checkbox" id="inputC">
D <input type="checkbox" id="inputD">
</div>

<button onclick="runHDL()">Run Simulation</button>

<h2>8-bit LED Output</h2>
<div id="ledArray" class="led-container"></div>

<h2>7-Segment Display (Lower 4 bits)</h2>
<div class="seven-segment">
    <div class="segment a"></div>
    <div class="segment b"></div>
    <div class="segment c"></div>
    <div class="segment d"></div>
    <div class="segment e"></div>
    <div class="segment f"></div>
    <div class="segment g"></div>
</div>

<script>

/* Create 8 LED outputs */
const ledContainer = document.getElementById("ledArray");
for (let i = 0; i < 8; i++) {
    const led = document.createElement("div");
    led.classList.add("led");
    ledContainer.appendChild(led);
}

/* 7 Segment Decoder */
const digitMap = {
    0: ['a','b','c','d','e','f'],
    1: ['b','c'],
    2: ['a','b','g','e','d'],
    3: ['a','b','g','c','d'],
    4: ['f','g','b','c'],
    5: ['a','f','g','c','d'],
    6: ['a','f','g','e','c','d'],
    7: ['a','b','c'],
    8: ['a','b','c','d','e','f','g'],
    9: ['a','b','c','d','f','g']
};

function updateSevenSegment(value) {
    const segments = document.querySelectorAll(".segment");
    segments.forEach(seg => seg.classList.remove("on"));

    if (digitMap[value]) {
        digitMap[value].forEach(s => {
            document.querySelector("." + s).classList.add("on");
        });
    }
}

/* Simple HDL Interpreter */
function runHDL() {
    const code = document.getElementById("hdlCode").value.toUpperCase();
    const A = document.getElementById("inputA").checked ? 1 : 0;
    const B = document.getElementById("inputB").checked ? 1 : 0;
    const C = document.getElementById("inputC").checked ? 1 : 0;
    const D = document.getElementById("inputD").checked ? 1 : 0;

    let result = 0;

    if (code.includes("AND")) {
        result = A & B;
    } 
    else if (code.includes("OR")) {
        result = A | B;
    } 
    else if (code.includes("XOR")) {
        result = A ^ B;
    } 
    else if (code.includes("NAND")) {
        result = !(A & B) ? 1 : 0;
    }
    else if (code.includes("NOT A")) {
        result = A ? 0 : 1;
    }

    /* Create 8-bit output (simple demo: replicate result) */
    let outputByte = "";
    for (let i = 0; i < 8; i++) {
        outputByte += result;
    }

    const leds = document.querySelectorAll(".led");

    for (let i = 0; i < 8; i++) {
        if (outputByte[i] === "1") {
            leds[i].classList.add("on");
        } else {
            leds[i].classList.remove("on");
        }
    }

    /* Lower 4 bits → decimal → 7 segment */
    const lowerNibble = parseInt(outputByte.slice(4), 2);
    updateSevenSegment(lowerNibble);
}

</script>

</body>
</html>
